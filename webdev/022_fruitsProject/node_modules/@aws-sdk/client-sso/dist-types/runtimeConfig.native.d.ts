{...t,[n]:{...e.entries[n],data:{...a,marked_as_spam:s}}}}),{});return{...e,entries:{...e.entries,...n}}}case v.REQUEST:case M:{const n=t.type===M&&!Array.isArray(t.payload),a=e.entryIdsByConversationId[s]||[],r=t.type===M?n?a:t.payload:[t.payload,...e.reactionsByMessageId[t.payload]||[]];return{...e,entries:(0,d.Z)(e.entries,r),entryIdsByConversationId:{...(0,d.Z)(e.entryIdsByConversationId,s),...n?{}:{[s]:(0,i.Z)(a,r)}},reactionsByMessageId:(0,d.Z)(e.reactionsByMessageId,r)}}case L:{const a=t.payload.id||n,r={...(0,d.Z)(e.entries,a)},i=R((e.entryIdsByConversationId[s]||[]).filter((e=>e!==a)),r),o=i?{[s]:i}:{};return{...e,entries:r,entryIdsByConversationId:{...(0,d.Z)(e.entryIdsByConversationId,s),...o},reactionsByMessageId:(0,d.Z)(e.reactionsByMessageId,a)}}case w:{const s=t.payload,n=[...e.reactionsByMessageId[s.message_id]||[],s.id],a=n.filter((t=>e.entries[t]));n.length!==a.length&&(0,u.ZP)("DM add reaction is missing a backing entry",{extra:{filteredMessageReactionIds:a,messageReactionIds:n,currentId:s.id}});const r=R(a,e.entries);return{...e,reactionsByMessageId:{...e.reactionsByMessageId,[s.message_id]:r}}}case T.REQUEST:case Z:{const s=t.payload,n=(e.reactionsByMessageId[s.message_id]||[]).find((t=>e.entries[t].data.sender_id===s.sender_id));if(!n)return e;const a=(0,i.Z)(e.entryIdsByConversationId[s.conversation_id],n),r=(0,i.Z)(e.reactionsByMessageId[s.message_id],n);return{...e,entries:(0,d.Z)(e.entries,n),entryIdsByConversationId:{...e.entryIdsByConversationId,[s.conversation_id]:a},reactionsByMessageId:{...e.reactionsByMessageId,[s.message_id]:r}}}case E.t:return m;default:return e}}const y=(e,t)=>{const{error:s,isLoaded:n,isLoading:a,...r}=e||{},{data:i,...o}=t||{};return{...r,data:{...r&&r.data,...i},...o}},R=(e=[],t)=>{const s=(0,c.Z)(e).sort(((e,s)=>{const n=(0,_.ZP)(t[e].data.time,t[s].data.time);return 0===n?(0,_.ZP)(t[e].id,t[s].id):n}));return s.length?s:void 0},N="rweb/directMessages/ADD_ENTRIES",C=e=>({payload:e,type:N}),g=e=>(t,s,{api:n})=>{const{conversationId:r,id:i,requestId:o,...d}=e||{},c={...d,id:i,request_id:o||a().v1()};return(0,l.AB)(t,{params:c,request:n.DirectMessages.deleteMessage})({actionTypes:v,context:"ACTION_DELETE_DM",payload:i,meta:{conversationId:r}})},D=e=>(t,s,{api:n})=>{const{perspective:a,...r}=e;re