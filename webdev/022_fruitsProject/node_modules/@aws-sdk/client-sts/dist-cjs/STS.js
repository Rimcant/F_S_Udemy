function _(e){const t=l(e);return t?new Date(t.date.year,t.date.month-1,t.date.day,t.time.hour,t.time.minute):null}function m(e){const t=new Date(e);return{date:{year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate()},time:{hour:t.getHours(),minute:t.getMinutes()}}}const w=s().aa2aa1a1,T=s().d725a289},38030:(e,t,r)=>{r.d(t,{CA:()=>d,Fq:()=>_,I4:()=>c,Le:()=>w,UD:()=>m,bR:()=>T});var o=r(26853),s=r(53392),a=r(23803);const n="draftTweets",i={fetchStatus:a.ZP.NONE,draftTweets:[]},d="FETCH_DRAFT_TWEETS",l=Object.freeze({REQUEST:"rweb/draftTweets/FETCH_DRAFT_TWEETS_REQUEST",SUCCESS:"rweb/draftTweets/FETCH_DRAFT_TWEETS_SUCCESS",FAILURE:"rweb/draftTweets/FETCH_DRAFT_TWEETS_FAILURE"}),c="DELETE_DRAFT_TWEET",u=Object.freeze({REQUEST:"rweb/draftTweets/DELETE_DRAFT_TWEET_REQUEST",SUCCESS:"rweb/draftTweets/DELETE_DRAFT_TWEET_SUCCESS",FAILURE:"rweb/draftTweets/DELETE_DRAFT_TWEET_FAILURE"});function p(e=i,t){switch(t.type){case l.SUCCESS:return{...e,fetchStatus:a.ZP.LOADED,draftTweets:t.payload||e.draftTweets};case l.FAILURE:return{...e,fetchStatus:a.ZP.FAILED};case l.REQUEST:return{...e,fetchStatus:a.ZP.LOADING};case u.SUCCESS:{const{meta:r}=t,o=(null==r?void 0:r.draftTweetId)&&e.draftTweets.filter((e=>e.rest_id!==r.draftTweetId));return o?{...e,draftTweets:o}:e}default:return e}}o.Z.register({[n]:p});const _=e=>e.draftTweets.draftTweets,m=e=>e.draftTweets.fetchStatus,w=()=>(e,t,{api:r})=>(0,s._O)(e,{request:r.Drafts.fetchDraftTweets,params:{}})({actionTypes:l,context:d}),T=e=>(t,r,{api:o})=>(0,s._O)(t,{request:o.Drafts.deleteDraftTweet,params:{draftTweetId:e}})({actionTypes:u,context:c,meta:{draftTweetId:e}})},12171:(e,t,r)=>{r.d(t,{Ed:()=>F,MH:()=>O,NS:()=>M,Ox:()=>L,Qx:()=>A,Qz:()=>y,W:()=>x,dD:()=>Z,wz:()=>U});r(6886),r(21515),r(36728);var o=r(73228),s=r.n(o),a=r(90867),n=r(63174),i=r(96965),d=r(26853),l=r(39581),c=r(18255),u=r(67935),p=r(61577),_=r(99629),m=r(20288),w=r(66040),T=r(30102),E=r(72504),h=r(65621),f=r(86538);Promise.resolve().then(r.bind(r,23335));const v="previews",y=20,S=Object.freeze({}),I="rweb/previews/STORE_PREVIEW",g="rweb/previews/REMOVE_PREVIEW_TWEET",C="rweb/previews/LINK_TWEET_TO_PREVIEW",R=s().g61ed8a4,D={};function P(e){return(0,p.Kc)(e).durationSecs||y}function b(e,t,r){var o;const s=null!=e&&e.errors?null==(o=e.errors[0])?void 0:o.code:null,a=e instanceof n.Z&&s?i.Z[s]:null,d={text:a&&a.toast?a.toast.text:R};r(_.fz(d))}d.Z.register({[v]:function(e=S,t){switch(t.type){case I:var r;return null!=t&&null!=(r=t.payload)&&r.id?{...e,[t.payload.id]:{...t.payload,linkedTweetIds:[]}}:e;case C:var o;return null!=t&&null!=(o=t.payload)&&o.id?{...e,[t.payload.id]:{...e[t.payload.id],linkedTweetIds:[...e[t.payload.id].linkedTweetIds,t.payload.linkedTweetId]}}:e;case g:if(t.payload){var s;const r=null==(s=e[t.payload])?void 0:s.timeoutId;r&&clearTimeout(r);const o={...e};return delete o[t.payload],o}return e;default:return e}}});const x=e=>e.previews,A=(e,{previewTweetId:t})=>x(e)[t],U=e=>({payload:e,type:C}),Z=e=>(t,r,{featureSwitches:o})=>{const s=A(r(),{previewTweetId:e});if(!s)return;const a=s.composerData.map((e=>({...e,draftTweetId:void 0})));t(m.RU(a,"modal")),t(L(e))},L=e=>(t,r,{featureSwitches:o})=>{var s,a;const n=(0,u.o1)(r()),i=A(r(),{previewTweetId:e}),d=null==i||null==(s=i.previewData)||null==(a=s.inReplyToStatus)?void 0:a.id_str,l=null==i?void 0:i.linkedTweetIds;if(void 0===n)return Promise.resolve();const c={[e]:!0};if(l&&l.length>0&&l.forEach((e=>{c[e]=!0})),d){t((0,E.ZP)({focalTweetId:d}).removeTweets(c))}return t(T.ZP.deletePreview(e)),t({payload:e,type:g}),Promise.resolve(t([(0,h.ZP)({useLatest:!0}).removeTweets(c),(0,h.ZP)({useLatest:!1}).removeTweets(c),(0,f.Z)(o,n,"default").removeTweets(c)]))},F=e=>(t,r)=>{const o=P(r()),s=1e3*o,{id:a,previewData:n}=e,i=Date.now()+s,d=r().tweetComposer.activeParentKey,c=(0,w.vY)(m.tS(r(),d),0,{}),u={subscription_details:{draft_id:a,undo_period:s/1e3,tweet_type:n.tweetType}};return new Promise((e=>{const r=setTimeout((()=>{t(l.n9({section:"composition",element:"undo_tweet",page:"home",action:"timer_elapsed"},u)),e(t(M(a)))}),s);t(l.n9({section:"composition",element:"undo_tweet",page:"home",action:"queued"},u)),t((e=>({payload:e,type:I}))({timeToSend:i,id:a,composerData:c,timeoutId:r,previewData:n,linkedTweetIds:[],undoDurationSecs:o}))}))},M=e=>(t,r)=>{if(!0===D[e])return Promise.resolve();const o=1e3*P(r()),s=A(r(),{previewTweetId:e});if(!s)return Promise.resolve();const{composerData:a,id:n,previewData:i}=s;return D[e]=!0,t(m.lW({...i,isPreview:!1,isSendPreview:!0})).then((()=>{const e={subscription_details:{draft_id:n,undo_period:o/1e3,tweet_type:i.tweetType}};t(l.n9({section:"composition",element:"undo_tweet",page:"app",action:"sent"},e))})).catch((e=>{b(e,0,t)})).finally((()=>{delete D[e],a.forEach((e=>{e.mediaIds.length&&t((0,c.WU)(e.mediaIds))})),t(L(n))}))},O=()=>(e,t)=>{const r=P(t()),o=x(t()),s=(0,a.Z)(o),n=[],i=[];for(const t in o)if(!0!==D[t]){D[t]=!0,i.push(t);const{previewData:s}=o[t],a={subscription_details:{draft_id:t,undo_period:r,tweet_type:s.tweetType}};n.push(e(m.lW({...s,isPreview:!1,isSendPreview:!0})),e(l.n9({element:"undo_tweet",page:"app",action:"send_unload"},a)))}return Promise.all(n).catch((t=>b(t,0,e))).finally((()=>{s.forEach((t=>{e(L(t.id))})),i.forEach((e=>{delete D[e]}))}))}},20288:(e,t,r)=>{r.d(t,{Bv:()=>ae,WV:()=>M,Ol:()=>se,oI:()=>W,$P:()=>ne,Es:()=>Te,RU:()=>me,Os:()=>O,E_:()=>J,oN:()=>X,tS:()=>G,KS:()=>$,WQ:()=>Y,R5:()=>te,ZE:()=>ee,_d:()=>re,lW:()=>k,jr:()=>ve,JC:()=>pe,sU:()=>he,JF:()=>ie,qO:()=>de,OO:()=>ce,wk:()=>Se,zi:()=>oe});r(6886),r(36728);var o=r(96014),s=